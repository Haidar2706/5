<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ê—É–∫—Ü–∏–æ–Ω</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    
    body {
      background: linear-gradient(135deg, #e0f7fa, #ffffff);
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .login-box, .main-box {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .header-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .header-bar h2 {
      margin: 0;
    }
    .search-panel {
      margin: 15px 0;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .search-panel input {
      flex: 1;
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .stats {
      font-weight: bold;
      margin: 10px 0;
    }
    .lots-table {
      width: 100%;
      border-collapse: collapse;
    }
    .lots-table th {
      background: #f0f0f0;
      padding: 10px;
    }
    .lots-table td {
      padding: 8px;
      border: 1px solid #ddd;
    }
    .admin-panel {
      margin-top: 20px;
      background: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
    }
    .btn {
      padding: 8px 12px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn:hover {
      background: #0056b3;
    }
    .modal {
     position: fixed;
     top: 0;
     left: 0;
     width: 100%;
     height: 100%;
     background: rgba(0,0,0,0.5);
     display: flex;
     justify-content: center;
     align-items: center;
     z-index: 1000;
    }

   .modal-content {
    background: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 400px;
   }

   .modal-buttons {
    display: flex;
    gap: 10px;
    margin-top: 15px;
   }
  </style>
 
</head>
<div id="modalOverlay" class="modal-overlay hidden">
  <div class="modal-content">
    <p id="modalMessage">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</p>
    <button class="btn" onclick="closeModal()">–û–ö</button>
  </div>
</div>

<body>
<div class="container">

  

  <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
  <div id="mainPage" class="main-box hidden">
    <div id="winnerBanner" class="hidden">üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∞—É–∫—Ü–∏–æ–Ω–µ!</div>

    <div class="header-bar">
      <h2>üèÜ –ê—É–∫—Ü–∏–æ–Ω</h2>
      <div>
        <span>–ü—Ä–∏–≤–µ—Ç, <b id="currentUser"></b>!</span>
        <button id="logoutBtn" class="btn" style="background:#dc3545; margin-left:10px;">–í—ã–π—Ç–∏</button>
      </div>
    </div>
    <label>‚è±Ô∏è –ù–∞—á–∞–ª–æ —Ç–æ—Ä–≥–æ–≤:</label>
    <input type="datetime-local" id="lotStartTime">
 

    <div class="links">
      <a href="history.html" class="btn" style="background:#28a745;">üìú –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</a>
      <a href="cabinet.html" class="btn" style="background:#17a2b8;">üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
      <a href="feedback.html" class="btn" style="background:#ffc107; color:#000;">üí¨ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</a>
      
      <a href="calendar.html" class="btn" style="background:#6f42c1;">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</a>
      <a href="soon.html" class="btn" style="background:#20c997;">üïí –°–∫–æ—Ä–æ</a>

    </div>
    
    


    <div class="search-panel">
      <input type="text" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é...">
      <button class="btn" onclick="filterMyBids()">üìå –ú–æ–∏ —Å—Ç–∞–≤–∫–∏</button>
      <button class="btn" onclick="renderLots()">üîÑ –í—Å–µ –ª–æ—Ç—ã</button>
    
    </div>
    <div class="sort-panel">
      <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</label>
      <select id="sortSelect">
        <option value="default">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
        <option value="priceAsc">–¶–µ–Ω–∞ ‚Üë</option>
        <option value="priceDesc">–¶–µ–Ω–∞ ‚Üì</option>
        <option value="endTime">–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è</option>
        <option value="bidsCount">–ö–æ–ª-–≤–æ —Å—Ç–∞–≤–æ–∫</option>
      </select>
    </div>
    <div id="nextAuctionBanner" class="hidden"></div>
    
    
    <div class="stats" id="statsPanel"></div>

    <div class="table-wrapper">
      <table id="lotsTable" class="hidden">
        <thead>
          <tr>
            <th>‚Ññ</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
            <th>–û–±—ä—ë–º</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–°—Ç–∞–≤–∫–∞</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
            <th>–û—Å—Ç–∞–ª–æ—Å—å</th>
            <th>–°—Ç–∞–≤–∫–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody id="lotsList"></tbody> <!-- ‚Üê –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù -->
      </table>
      
      </table>
    </div>
    <div id="nextAuctionBanner" style="
    display:none; 
    text-align:center; 
    margin-top:20px; 
    font-size:18px; 
    font-weight:bold;
    color:#d9534f;
    "></div>
    <div id="soonLots" style="display:none;">
      <h3>üïí –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ—Ç—ã</h3>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
            <th>–†–∞–∑–º–µ—Ä</th>
            <th>–°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ü–µ–Ω–∞</th>
            <th>–ù–∞—á–∞–ª–æ —Ç–æ—Ä–≥–æ–≤</th>
          </tr>
        </thead>
        <tbody id="soonLotsBody"></tbody>
      </table>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
    <div id="adminPanel" class="admin-panel hidden">
      <h3>üëë –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
      <div style="margin: 10px 0;">
        <label>üìÖ –° –¥–∞—Ç—ã: <input type="date" id="filterStartDate"></label>
        <label>–ø–æ: <input type="date" id="filterEndDate"></label>
        <button class="btn" onclick="renderWinners()">üîç –ü–æ–∫–∞–∑–∞—Ç—å</button>
      </div>
      
      <div id="winnersPanel" style="margin:15px 0;"></div>
      <div style="margin:10px 0;">
        <button class="btn" onclick="downloadWinnersExcel()">üìä –°–∫–∞—á–∞—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π (Excel)</button>
        <button class="btn" style="background:#dc3545;" onclick="clearWinners()">üóë –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π</button>
      </div>      
      <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h4>
      <form id="addUserForm">
        <input type="text" id="newUsername" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required />
        <input type="password" id="newPassword" placeholder="–ü–∞—Ä–æ–ª—å" required />
        <select id="newUserRole">
          <option value="user">–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
          <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
        </select>
        <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
      </form>

      <hr>
      <h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ª–æ—Ç</h4>
      <form id="addLotForm">
        <input type="number" id="newLotMinVolume" placeholder="–ú–∏–Ω. –æ–±—ä—ë–º" required />
        <input type="number" id="newLotMinBid" placeholder="–ú–∏–Ω. —Å—Ç–∞–≤–∫–∞" required />
        <input type="text" id="newLotTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required />
        <input type="text" id="newLotCategory" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è" required />
        <input type="number" id="newLotPrice" placeholder="–¶–µ–Ω–∞" required />
        <input type="text" id="newLotSize" placeholder="–†–∞–∑–º–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 —Ç–æ–Ω–Ω)" required />
        <label>‚è±Ô∏è –ù–∞—á–∞–ª–æ —Ç–æ—Ä–≥–æ–≤:</label>
        <input type="datetime-local" id="newLotStartTime" required />
        <label>‚è∞ –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è:</label>
        <input type="datetime-local" id="newLotEndTime" required />
        <select id="newLotStatus">
          <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–π</option>
          <option value="sold">–ü—Ä–æ–¥–∞–Ω</option>
        </select>
        <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å –ª–æ—Ç</button>
      </form>

      <hr>
      <h4>üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h4>
      <button class="btn" onclick="saveToLocalStorage()">üíΩ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ LocalStorage</button>
      <button class="btn" onclick="loadFromLocalStorage()">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ LocalStorage</button>
      <button class="btn" onclick="downloadJSON()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å JSON</button>
      <br><br>
      <label>üìÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel (.xlsx):
        <input type="file" accept=".xlsx" onchange="handleExcelUpload(event)">
      </label>
      <br>
      <label>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON:
        <input type="file" accept="application/json" onchange="uploadJSONFile(event)">
      </label>
      <hr>
  <h4>üë• –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
  
  <div class="admin-controls">
    <label>
      –†–æ–ª—å:
      <select id="userRoleFilter">
        <option value="all">–í—Å–µ</option>
        <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
        <option value="admin">–ê–¥–º–∏–Ω—ã</option>
      </select>
    </label>
    <button onclick="loadUsersHistory()" class="btn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
  </div>
  
  <table id="usersHistoryTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>–õ–æ–≥–∏–Ω</th>
        <th>–†–æ–ª—å</th>
        <th>–°—Ç–∞–≤–æ–∫</th>
        <th>–ü–æ–±–µ–¥</th>
        <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
        <th>–î–µ–π—Å—Ç–≤–∏—è</th> <!-- –ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
      </tr>
    </thead>
    <tbody id="usersHistoryBody"></tbody>
  </table>
  
  <button onclick="downloadUsersExcel()" class="btn-download">üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
</div>
    </div>
  </div>
</div>

<script src="auction.js" defer></script>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<button class="btn" onclick="toggleTheme()">üåì –¢–µ–º–∞</button>

</body>
</html>
